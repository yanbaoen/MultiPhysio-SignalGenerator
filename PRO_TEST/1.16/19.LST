C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 1   


C51 COMPILER V8.08, COMPILATION OF MODULE 19
OBJECT MODULE PLACED IN 19.OBJ
COMPILER INVOKED BY: E:\Program Files (x86)\Keil\C51\BIN\C51.EXE 19.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include<reg52.h>                                                       //包含51单片机寄存器定义的头文件
   2          #include<intrins.h>     
   3          #define uint unsigned int
   4          #define uchar unsigned char
   5          #define Channal_A     1    //通道A
   6          #define Channal_B     2    //通道B
   7          #define Channal_AB    3    //通道A&B
   8          #define MCP42100_ENABLE()               MCP42100_CS = 0//使能
   9          #define MCP42100_DISABLE()              MCP42100_CS = 1//使能
  10          #define MCP42100_SCK_H()                MCP42100_SCK = 1//
  11          #define MCP42100_SCK_L()                MCP42100_SCK = 0//
  12          #define MCP42100_SI_H()                 MCP42100_SI = 1//
  13          #define MCP42100_SI_L()                 MCP42100_SI = 0//
  14          
  15          #define MCP42100_NONE                                   0x10
  16          #define MCP42100_P0                                             0x11
  17          #define MCP42100_P1                                             0x12
  18          #define MCP42100_ALL                                    0x13                    
  19          //**************************下为函数声明修**************************************
  20          static void DA_conver(uint Dignum);
  21          extern void Write_A_B(uint Data_A,uint Data_B,uchar Channal,bit Model);
  22          void InitUART  (void);
  23          void SendByte(unsigned char dat);
  24          void SendStr(unsigned char *s);
  25          void MCP42100_Control(uint _ch,uint _value);
  26          
  27          sbit DIN   = P1^0;     //数据输入端
  28          sbit SCLK = P1^1;     //时钟信号
  29          sbit CS    = P1^2;     //片选输入端，低电平有效
  30          sbit MCP42100_CS  = P1^6;
  31          sbit MCP42100_SCK = P1^5;                       
  32          sbit MCP42100_SI  = P1^4;
  33          static uint new = 1;
  34          uint code ECG1[1000];
  35          
  36          //=================================================================
  37          //*******************  串口初始化*******************
  38          void InitUART  (void)
  39          {
  40   1          SCON  =0x50;       // SCON: 模式 1, 8-bit UART, 使能接收 
  41   1          TMOD |= 0x20;      // TMOD:timer 1, mode 2, 8-bit 重装
  42   1          TH1 =TL1= 0xFD;   // TH1:  重装值9600 波特率 晶振 11.0592MHz  
  43   1          TR1   =1;               // TR1: timer 1 打开                     
  44   1          EA   = 1;              //打开总中断
  45   1          ES   = 1;              //打开串口中断
  46   1      }   
  47          //******************* 发送一个字节 *******************
  48          void SendByte(unsigned char dat)
  49          {
  50   1         SBUF = dat;
  51   1         while(!TI);
  52   1         TI = 0;  
  53   1      }
  54          //**************** 发送一个字符串 *******************
  55          void SendStr(unsigned char *s)
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 2   

  56          {
  57   1          while(*s!='\0')   // \0表示字符串结束标志，通过检测是否字符串末尾
  58   1          {
  59   2             SendByte(*s);
  60   2             s++;
  61   2          }
  62   1      }
  63          //****************** 串口中断程序 *******************
  64          void UART_SER (void) interrupt 4 
  65          {
  66   1         unsigned char Temp; 
  67   1           
  68   1         if(RI)                           //判断是接收中断产生
  69   1         {
  70   2          RI=0;                      //标志位清零
  71   2          Temp=SBUF;
  72   2              new = Temp;
  73   2          /* switch(Temp){
  74   2              case 0x00:
  75   2                      new = 1;
  76   2                      break;
  77   2              case 0x80: 
  78   2                      new = 2;
  79   2                      break;
  80   2              default:
  81   2                      new = 3;
  82   2                      break;
  83   2              } */
  84   2          SendByte(Temp);
  85   2              }  //把接收到的值再发回电脑端
  86   1      }
  87          uint code ECG1[1000]=                                   
  88          {0x4CF,
  89          0x4C7,
  90          0x4CF,
  91          0x4B7,
  92          0x4C7,
  93          0x4BF,
  94          0x4BF,
  95          0x49F,
  96          0x4AF,
  97          0x497,
  98          0x4AF,
  99          0x497,
 100          0x4AF,
 101          0x497,
 102          0x4A7,
 103          0x49F,
 104          0x49F,
 105          0x48F,
 106          0x4A7,
 107          0x487,
 108          0x49F,
 109          0x4E7,
 110          0x538,
 111          0x548,
 112          0x578,
 113          0x629,
 114          0x611,
 115          0x578,
 116          0x538,
 117          0x4EF,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 3   

 118          0x4A7,
 119          0x3EE,
 120          0x3F6,
 121          0x3EE,
 122          0x3EE,
 123          0x3AD,
 124          0x45E,
 125          0x753,
 126          0xC72,
 127          0xE6D,
 128          0x436,
 129          0x0,
 130          0x17A,
 131          0x2FC,
 132          0x436,
 133          0x41E,
 134          0x44E,
 135          0x436,
 136          0x476,
 137          0x466,
 138          0x49F,
 139          0x497,
 140          0x4C7,
 141          0x4D7,
 142          0x517,
 143          0x527,
 144          0x568,
 145          0x578,
 146          0x5C0,
 147          0x5E0,
 148          0x621,
 149          0x651,
 150          0x679,
 151          0x699,
 152          0x6A2,
 153          0x691,
 154          0x6AA,
 155          0x6A2,
 156          0x671,
 157          0x641,
 158          0x5F1,
 159          0x5A8,
 160          0x570,
 161          0x550,
 162          0x538,
 163          0x527,
 164          0x527,
 165          0x51F,
 166          0x517,
 167          0x51F,
 168          0x52F,
 169          0x527,
 170          0x50F,
 171          0x50F,
 172          0x517,
 173          0x507,
 174          0x4F7,
 175          0x4E7,
 176          0x4E7,
 177          0x4CF,
 178          0x4C7,
 179          0x4BF,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 4   

 180          0x4D7,
 181          0x4CF,
 182          0x4AF,
 183          0x4B7,
 184          0x49F,
 185          0x4C7,
 186          0x4B7,
 187          0x4AF,
 188          0x4AF,
 189          0x4A7,
 190          0x49F,
 191          0x4B7,
 192          0x4A7,
 193          0x497,
 194          0x487,
 195          0x49F,
 196          0x497,
 197          0x4BF,
 198          0x4E7,
 199          0x538,
 200          0x560,
 201          0x5A0,
 202          0x669,
 203          0x619,
 204          0x580,
 205          0x517,
 206          0x507,
 207          0x476,
 208          0x40E,
 209          0x3FE,
 210          0x406,
 211          0x406,
 212          0x3D6,
 213          0x540,
 214          0x8CD,
 215          0xCA2,
 216          0xB38,
 217          0x42E,
 218          0x89,
 219          0x12A,
 220          0x2FC,
 221          0x416,
 222          0x446,
 223          0x43E,
 224          0x446,
 225          0x487,
 226          0x46E,
 227          0x49F,
 228          0x4A7,
 229          0x4BF,
 230          0x4EF,
 231          0x50F,
 232          0x538,
 233          0x550,
 234          0x578,
 235          0x5B0,
 236          0x5E8,
 237          0x611,
 238          0x639,
 239          0x681,
 240          0x661,
 241          0x691,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 5   

 242          0x681,
 243          0x689,
 244          0x689,
 245          0x631,
 246          0x609,
 247          0x5D0,
 248          0x580,
 249          0x568,
 250          0x527,
 251          0x538,
 252          0x527,
 253          0x517,
 254          0x50F,
 255          0x51F,
 256          0x52F,
 257          0x50F,
 258          0x527,
 259          0x4EF,
 260          0x4F7,
 261          0x4DF,
 262          0x4EF,
 263          0x4D7,
 264          0x4B7,
 265          0x4DF,
 266          0x4B7,
 267          0x49F,
 268          0x4AF,
 269          0x49F,
 270          0x4AF,
 271          0x4B7,
 272          0x4A7,
 273          0x4A7,
 274          0x497,
 275          0x497,
 276          0x487,
 277          0x4AF,
 278          0x476,
 279          0x48F,
 280          0x497,
 281          0x48F,
 282          0x4B7,
 283          0x527,
 284          0x540,
 285          0x588,
 286          0x659,
 287          0x619,
 288          0x5A8,
 289          0x527,
 290          0x507,
 291          0x47E,
 292          0x416,
 293          0x40E,
 294          0x3CD,
 295          0x416,
 296          0x3AD,
 297          0x4FF,
 298          0x884,
 299          0xCCA,
 300          0xCDA,
 301          0x487,
 302          0x30,
 303          0xD9,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 6   

 304          0x2D4,
 305          0x426,
 306          0x436,
 307          0x456,
 308          0x43E,
 309          0x46E,
 310          0x46E,
 311          0x49F,
 312          0x497,
 313          0x4DF,
 314          0x4DF,
 315          0x51F,
 316          0x527,
 317          0x560,
 318          0x5B0,
 319          0x5A8,
 320          0x619,
 321          0x629,
 322          0x671,
 323          0x671,
 324          0x6B2,
 325          0x6AA,
 326          0x6BA,
 327          0x6BA,
 328          0x689,
 329          0x651,
 330          0x621,
 331          0x5C0,
 332          0x568,
 333          0x558,
 334          0x52F,
 335          0x517,
 336          0x4FF,
 337          0x52F,
 338          0x50F,
 339          0x527,
 340          0x507,
 341          0x4FF,
 342          0x517,
 343          0x51F,
 344          0x4F7,
 345          0x4EF,
 346          0x4DF,
 347          0x4E7,
 348          0x4EF,
 349          0x4B7,
 350          0x4C7,
 351          0x497,
 352          0x4A7,
 353          0x4A7,
 354          0x49F,
 355          0x48F,
 356          0x48F,
 357          0x4AF,
 358          0x487,
 359          0x487,
 360          0x48F,
 361          0x487,
 362          0x497,
 363          0x48F,
 364          0x49F,
 365          0x4F7,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 7   

 366          0x540,
 367          0x568,
 368          0x5A0,
 369          0x661,
 370          0x5F9,
 371          0x578,
 372          0x4F7,
 373          0x4CF,
 374          0x436,
 375          0x3DE,
 376          0x3C5,
 377          0x3EE,
 378          0x3D6,
 379          0x385,
 380          0x5A0,
 381          0xA9F,
 382          0xE95,
 383          0x91D,
 384          0x26B,
 385          0x10,
 386          0x16A,
 387          0x33D,
 388          0x416,
 389          0x40E,
 390          0x426,
 391          0x456,
 392          0x456,
 393          0x476,
 394          0x487,
 395          0x4A7,
 396          0x4CF,
 397          0x4FF,
 398          0x50F,
 399          0x548,
 400          0x580,
 401          0x5A0,
 402          0x5D8,
 403          0x639,
 404          0x671,
 405          0x679,
 406          0x6AA,
 407          0x6AA,
 408          0x6DA,
 409          0x6D2,
 410          0x6AA,
 411          0x689,
 412          0x641,
 413          0x5F9,
 414          0x5C0,
 415          0x558,
 416          0x517,
 417          0x4FF,
 418          0x4F7,
 419          0x4EF,
 420          0x4EF,
 421          0x4F7,
 422          0x4EF,
 423          0x50F,
 424          0x4EF,
 425          0x4EF,
 426          0x4FF,
 427          0x4E7,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 8   

 428          0x4C7,
 429          0x4CF,
 430          0x4CF,
 431          0x49F,
 432          0x4AF,
 433          0x497,
 434          0x4A7,
 435          0x487,
 436          0x49F,
 437          0x48F,
 438          0x487,
 439          0x476,
 440          0x48F,
 441          0x476,
 442          0x47E,
 443          0x456,
 444          0x497,
 445          0x466,
 446          0x487,
 447          0x4A7,
 448          0x517,
 449          0x550,
 450          0x560,
 451          0x609,
 452          0x631,
 453          0x5D8,
 454          0x560,
 455          0x4DF,
 456          0x4DF,
 457          0x41E,
 458          0x3E6,
 459          0x3D6,
 460          0x416,
 461          0x3DE,
 462          0x3D6,
 463          0x649,
 464          0xC09,
 465          0xFDF,
 466          0x74A,
 467          0x152,
 468          0xC1,
 469          0x24B,
 470          0x416,
 471          0x426,
 472          0x446,
 473          0x436,
 474          0x476,
 475          0x46E,
 476          0x487,
 477          0x487,
 478          0x4A7,
 479          0x4CF,
 480          0x517,
 481          0x527,
 482          0x550,
 483          0x580,
 484          0x5B0,
 485          0x5D8,
 486          0x651,
 487          0x679,
 488          0x6B2,
 489          0x6AA,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 9   

 490          0x6E2,
 491          0x6E2,
 492          0x6F2,
 493          0x6D2,
 494          0x6A2,
 495          0x649,
 496          0x609,
 497          0x5C0,
 498          0x578,
 499          0x52F,
 500          0x527,
 501          0x507,
 502          0x507,
 503          0x507,
 504          0x50F,
 505          0x52F,
 506          0x527,
 507          0x527,
 508          0x527,
 509          0x527,
 510          0x51F,
 511          0x507,
 512          0x50F,
 513          0x4EF,
 514          0x4EF,
 515          0x4EF,
 516          0x4DF,
 517          0x4CF,
 518          0x4DF,
 519          0x4C7,
 520          0x4CF,
 521          0x4BF,
 522          0x4CF,
 523          0x49F,
 524          0x4AF,
 525          0x497,
 526          0x4A7,
 527          0x48F,
 528          0x49F,
 529          0x497,
 530          0x4A7,
 531          0x48F,
 532          0x4B7,
 533          0x497,
 534          0x4AF,
 535          0x4B7,
 536          0x52F,
 537          0x560,
 538          0x568,
 539          0x609,
 540          0x619,
 541          0x5A0,
 542          0x548,
 543          0x4E7,
 544          0x4D7,
 545          0x406,
 546          0x3FE,
 547          0x3CD,
 548          0x40E,
 549          0x3DE,
 550          0x406,
 551          0x691,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 10  

 552          0xC6A,
 553          0xFFF,
 554          0x629,
 555          0xC9,
 556          0x109,
 557          0x2A4,
 558          0x43E,
 559          0x42E,
 560          0x456,
 561          0x446,
 562          0x46E,
 563          0x466,
 564          0x49F,
 565          0x49F,
 566          0x4D7,
 567          0x4EF,
 568          0x517,
 569          0x52F,
 570          0x560,
 571          0x580,
 572          0x5C8,
 573          0x5E0,
 574          0x639,
 575          0x661,
 576          0x6A2,
 577          0x6BA,
 578          0x6CA,
 579          0x6CA,
 580          0x6DA,
 581          0x6CA,
 582          0x6A2,
 583          0x659,
 584          0x619,
 585          0x5D0,
 586          0x590,
 587          0x558,
 588          0x558,
 589          0x540,
 590          0x540,
 591          0x540,
 592          0x548,
 593          0x540,
 594          0x558,
 595          0x550,
 596          0x550,
 597          0x550,
 598          0x548,
 599          0x52F,
 600          0x52F,
 601          0x51F,
 602          0x517,
 603          0x50F,
 604          0x4FF,
 605          0x4F7,
 606          0x4F7,
 607          0x4E7,
 608          0x4EF,
 609          0x4E7,
 610          0x4E7,
 611          0x4D7,
 612          0x4E7,
 613          0x4D7,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 11  

 614          0x4E7,
 615          0x4CF,
 616          0x4DF,
 617          0x4CF,
 618          0x4D7,
 619          0x4AF,
 620          0x4C7,
 621          0x49F,
 622          0x4B7,
 623          0x49F,
 624          0x4BF,
 625          0x4B7,
 626          0x4C7,
 627          0x4AF,
 628          0x4C7,
 629          0x4FF,
 630          0x558,
 631          0x570,
 632          0x598,
 633          0x651,
 634          0x619,
 635          0x588,
 636          0x548,
 637          0x4F7,
 638          0x4CF,
 639          0x416,
 640          0x41E,
 641          0x3F6,
 642          0x416,
 643          0x3CD,
 644          0x476,
 645          0x76B,
 646          0xCFB,
 647          0xF36,
 648          0x476,
 649          0x10,
 650          0x1A2,
 651          0x34D,
 652          0x45E,
 653          0x42E,
 654          0x45E,
 655          0x456,
 656          0x47E,
 657          0x46E,
 658          0x49F,
 659          0x4A7,
 660          0x4D7,
 661          0x4EF,
 662          0x527,
 663          0x52F,
 664          0x570,
 665          0x580,
 666          0x5C8,
 667          0x5F9,
 668          0x641,
 669          0x661,
 670          0x691,
 671          0x6A2,
 672          0x6BA,
 673          0x6C2,
 674          0x6D2,
 675          0x6B2,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 12  

 676          0x691,
 677          0x649,
 678          0x609,
 679          0x5B8,
 680          0x588,
 681          0x550,
 682          0x548,
 683          0x540,
 684          0x540,
 685          0x52F,
 686          0x52F,
 687          0x52F,
 688          0x540,
 689          0x538,
 690          0x550,
 691          0x540,
 692          0x52F,
 693          0x51F,
 694          0x517,
 695          0x50F,
 696          0x50F,
 697          0x507,
 698          0x4F7,
 699          0x4FF,
 700          0x4E7,
 701          0x4DF,
 702          0x4DF,
 703          0x4D7,
 704          0x4C7,
 705          0x4C7,
 706          0x4CF,
 707          0x4C7,
 708          0x4BF,
 709          0x4CF,
 710          0x4CF,
 711          0x4D7,
 712          0x4CF,
 713          0x4C7,
 714          0x4AF,
 715          0x4C7,
 716          0x4AF,
 717          0x4C7,
 718          0x4B7,
 719          0x4BF,
 720          0x4A7,
 721          0x4BF,
 722          0x4A7,
 723          0x4B7,
 724          0x4A7,
 725          0x4CF,
 726          0x4E7,
 727          0x550,
 728          0x570,
 729          0x588,
 730          0x651,
 731          0x629,
 732          0x590,
 733          0x550,
 734          0x507,
 735          0x4D7,
 736          0x40E,
 737          0x42E,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 13  

 738          0x41E,
 739          0x426,
 740          0x3F6,
 741          0x48F,
 742          0x763,
 743          0xC32,
 744          0xE95,
 745          0x4EF,
 746          0x99,
 747          0x14A,
 748          0x2E4,
 749          0x45E,
 750          0x43E,
 751          0x456,
 752          0x43E,
 753          0x46E,
 754          0x45E,
 755          0x487,
 756          0x49F,
 757          0x4D7,
 758          0x4CF,
 759          0x4F7,
 760          0x517,
 761          0x550,
 762          0x578,
 763          0x598,
 764          0x5C8,
 765          0x619,
 766          0x651,
 767          0x689,
 768          0x671,
 769          0x699,
 770          0x6AA,
 771          0x6BA,
 772          0x6AA,
 773          0x699,
 774          0x649,
 775          0x601,
 776          0x5C0,
 777          0x580,
 778          0x568,
 779          0x548,
 780          0x538,
 781          0x52F,
 782          0x527,
 783          0x52F,
 784          0x52F,
 785          0x52F,
 786          0x52F,
 787          0x527,
 788          0x527,
 789          0x50F,
 790          0x50F,
 791          0x4EF,
 792          0x4DF,
 793          0x4CF,
 794          0x4CF,
 795          0x4CF,
 796          0x4BF,
 797          0x4C7,
 798          0x4B7,
 799          0x4BF,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 14  

 800          0x4C7,
 801          0x4B7,
 802          0x4B7,
 803          0x4B7,
 804          0x49F,
 805          0x4B7,
 806          0x4A7,
 807          0x4AF,
 808          0x49F,
 809          0x4B7,
 810          0x49F,
 811          0x4AF,
 812          0x49F,
 813          0x4AF,
 814          0x48F,
 815          0x4A7,
 816          0x48F,
 817          0x4B7,
 818          0x4A7,
 819          0x49F,
 820          0x4B7,
 821          0x517,
 822          0x558,
 823          0x588,
 824          0x629,
 825          0x631,
 826          0x5C8,
 827          0x548,
 828          0x4F7,
 829          0x4DF,
 830          0x416,
 831          0x41E,
 832          0x3FE,
 833          0x416,
 834          0x3EE,
 835          0x487,
 836          0x74A,
 837          0xC11,
 838          0xE6D,
 839          0x598,
 840          0x109,
 841          0xD9,
 842          0x26B,
 843          0x406,
 844          0x42E,
 845          0x456,
 846          0x456,
 847          0x476,
 848          0x476,
 849          0x47E,
 850          0x497,
 851          0x4D7,
 852          0x4DF,
 853          0x517,
 854          0x527,
 855          0x578,
 856          0x580,
 857          0x5C8,
 858          0x5F1,
 859          0x639,
 860          0x659,
 861          0x681,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 15  

 862          0x699,
 863          0x6BA,
 864          0x6B2,
 865          0x6B2,
 866          0x6AA,
 867          0x681,
 868          0x639,
 869          0x5F9,
 870          0x5A0,
 871          0x578,
 872          0x540,
 873          0x550,
 874          0x538,
 875          0x52F,
 876          0x52F,
 877          0x52F,
 878          0x52F,
 879          0x52F,
 880          0x527,
 881          0x51F,
 882          0x527,
 883          0x507,
 884          0x527,
 885          0x4EF,
 886          0x4EF,
 887          0x4E7,
 888          0x4E7,
 889          0x4EF,
 890          0x4D7,
 891          0x4C7,
 892          0x4DF,
 893          0x4C7,
 894          0x4C7,
 895          0x4C7,
 896          0x4C7,
 897          0x4BF,
 898          0x4C7,
 899          0x4BF,
 900          0x4C7,
 901          0x4BF,
 902          0x4BF,
 903          0x4A7,
 904          0x4CF,
 905          0x49F,
 906          0x4C7,
 907          0x4A7,
 908          0x4AF,
 909          0x4A7,
 910          0x4DF,
 911          0x49F,
 912          0x4B7,
 913          0x4D7,
 914          0x538,
 915          0x588,
 916          0x590,
 917          0x631,
 918          0x629,
 919          0x5B0,
 920          0x548,
 921          0x50F,
 922          0x4E7,
 923          0x41E,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 16  

 924          0x41E,
 925          0x416,
 926          0x42E,
 927          0x3EE,
 928          0x487,
 929          0x773,
 930          0xC7A,
 931          0xEED,
 932          0x5A0,
 933          0xD9,
 934          0x109,
 935          0x29C,
 936          0x436,
 937          0x436,
 938          0x456,
 939          0x456,
 940          0x487,
 941          0x47E,
 942          0x4A7,
 943          0x49F,
 944          0x4C7,
 945          0x4E7,
 946          0x527,
 947          0x52F,
 948          0x570,
 949          0x598,
 950          0x5D0,
 951          0x5F1,
 952          0x649,
 953          0x661,
 954          0x6A2,
 955          0x6CA,
 956          0x6E2,
 957          0x6DA,
 958          0x6EA,
 959          0x6BA,
 960          0x689,
 961          0x649,
 962          0x611,
 963          0x5C8,
 964          0x570,
 965          0x558,
 966          0x548,
 967          0x52F,
 968          0x52F,
 969          0x52F,
 970          0x52F,
 971          0x52F,
 972          0x52F,
 973          0x52F,
 974          0x52F,
 975          0x527,
 976          0x51F,
 977          0x51F,
 978          0x517,
 979          0x4FF,
 980          0x4F7,
 981          0x4E7,
 982          0x4E7,
 983          0x4DF,
 984          0x4E7,
 985          0x4C7,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 17  

 986          0x4BF,
 987          0x4B7,
 988          0x4BF,
 989          0x49F,
 990          0x4A7,
 991          0x49F,
 992          0x4BF,
 993          0x4A7,
 994          0x4A7,
 995          0x497,
 996          0x4A7,
 997          0x49F,
 998          0x4A7,
 999          0x49F,
1000          0x49F,
1001          0x48F,
1002          0x49F,
1003          0x487,
1004          0x49F,
1005          0x48F,
1006          0x4A7,
1007          0x4D7,
1008          0x52F,
1009          0x568,
1010          0x580,
1011          0x641,
1012          0x609,
1013          0x590,
1014          0x540,
1015          0x4F7,
1016          0x4B7,
1017          0x3FE,
1018          0x406,
1019          0x3E6,
1020          0x40E,
1021          0x3C5,
1022          0x47E,
1023          0x793,
1024          0xCD2,
1025          0xEE5,
1026          0x507,
1027          0x61,
1028          0x14A,
1029          0x2DC,
1030          0x436,
1031          0x41E,
1032          0x446,
1033          0x42E,
1034          0x45E,
1035          0x446,
1036          0x466,
1037          0x46E,
1038          0x4AF,
1039          0x4C7,
1040          0x4F7,
1041          0x50F,
1042          0x540,
1043          0x568,
1044          0x5B0,
1045          0x5D8,
1046          0x629,
1047          0x651,
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 18  

1048          0x691,
1049          0x699,
1050          0x6B2,
1051          0x6AA,
1052          0x6BA,
1053          0x699,
1054          0x671,
1055          0x629,
1056          0x5E8,
1057          0x5A8,
1058          0x580,
1059          0x550,
1060          0x52F,
1061          0x51F,
1062          0x517,
1063          0x51F,
1064          0x51F,
1065          0x527,
1066          0x52F,
1067          0x52F,
1068          0x52F,
1069          0x52F,
1070          0x52F,
1071          0x527,
1072          0x51F,
1073          0x50F,
1074          0x507,
1075          0x4F7,
1076          0x4E7,
1077          0x4D7,
1078          0x4D7,
1079          0x4CF,
1080          0x4CF,
1081          0x4CF,
1082          0x4D7,
1083          0x4D7,
1084          0x4D7,
1085          0x4C7,
1086          0x4CF,
1087          0x4D7
1088          };
1089          
1090          void DA_conver(uint Dignum)
1091          {
1092   1      uint Dig=0;
1093   1      uchar i=0;
1094   1      SCLK=1;
1095   1      CS=0;           //片选有效
1096   1      for(i=0;i<16;i++)   //写入16为Bit的控制位和数据
1097   1      {
1098   2         Dig=Dignum&0x8000;
1099   2         if(Dig)
1100   2         {
1101   3          DIN=1;
1102   3         }
1103   2         else
1104   2         {
1105   3          DIN=0;
1106   3         }
1107   2         SCLK=0;
1108   2         _nop_();
1109   2         Dignum<<=1;
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 19  

1110   2         SCLK=1;
1111   2         _nop_();
1112   2      }
1113   1      SCLK=1;
1114   1      CS=1;       //片选无效
1115   1      }
1116          
1117          void MCP42100_Control(uint _ch,uint _value)
1118          {        
1119   1              uint i = 0;
1120   1              MCP42100_ENABLE();         
1121   1              for(i = 0;i<8;i++)
1122   1              {
1123   2                      MCP42100_SCK_L(); 
1124   2                      if(_ch & (0x80>>i)) MCP42100_SI_H();
1125   2                      else MCP42100_SI_L();
1126   2                      _nop_();
1127   2                      MCP42100_SCK_H();
1128   2                      _nop_();
1129   2              }
1130   1              for(i = 0;i<8;i++)
1131   1              {
1132   2                      MCP42100_SCK_L();
1133   2                      if(_value & (0x80>>i)) MCP42100_SI_H();
1134   2                      else MCP42100_SI_L();
1135   2                      _nop_();
1136   2                      MCP42100_SCK_H();
1137   2                      _nop_();
1138   2              }
1139   1              MCP42100_SCK_L();                               
1140   1              MCP42100_DISABLE();                                             
1141   1      }
1142          //=================================================================
1143          // 函数名称 ：void Write_A_B(uint Data_A,uint Data_B,uchar Channal,bit Model)
1144          // 函数功能 ：模式、通道选择并进行DA转换
1145          // 入口参数 ：Data_A：A通道转换的电压值
1146          //            Data_B：B通道转换的电压值
1147          //            Channal：通道选择，其值为Channal_A，Channal_B,或Channal_AB
1148          //            Model：速度控制位 0：slow mode 1：fast mode
1149          // 出口参数 ：无
1150          // 说明：     Data_A，Data_B的范围为：0―0x0fff
1151          //            本程序如果只需要一个通道时，另外一个通道的值可任意，但是不能缺省
1152          //=================================================================
1153          void Write_A_B(uint Data_A,uint Data_B,uchar Channal,bit Model)
1154          {
1155   1      uint Temp;
1156   1      if(Model)
1157   1      {
1158   2         Temp=0x4000;
1159   2      }
1160   1      else
1161   1          {
1162   2         Temp=0x0000;
1163   2      }
1164   1      switch(Channal)
1165   1      {
1166   2          case Channal_A:         //A通道
1167   2               DA_conver(Temp|0x8000|(0x0fff&Data_A));
1168   2            break;
1169   2          case Channal_B:       //B通道
1170   2               DA_conver(Temp|0x0000|(0x0fff&Data_B));
1171   2          break;
C51 COMPILER V8.08   19                                                                    01/16/2019 14:51:23 PAGE 20  

1172   2          case Channal_AB:
1173   2               DA_conver(Temp|0x1000|(0x0fff&Data_B));        //A&B通道
1174   2               DA_conver(Temp|0x8000|(0x0fff&Data_A));
1175   2          break;
1176   2          default:
1177   2               break;
1178   2      }
1179   1      }
1180          //=================================================================
1181          // 函数名称 ：int main(void)
1182          // 函数功能 ：主函数，无实际意义,仅测试TLV5618用
1183          // 入口参数 ：无 1-A;2-B;3-A&B
1184          // 出口参数 ：无
1185          //=================================================================
1186          int main(void)
1187          {
1188   1              uint i; 
1189   1              InitUART();
1190   1         while(1)
1191   1         {
1192   2      /*      switch(new){
1193   2              case 1:
1194   2                      for(i=0;i<999;i++)
1195   2                      Write_A_B(ECG1[i],ECG1[i],Channal_AB,1);
1196   2                      break;
1197   2              case 2: 
1198   2                      for(i=0;i<999;i++)
1199   2                      Write_A_B(ECG1[i]/10,ECG1[i]/10,Channal_AB,1);
1200   2                      break;
1201   2                      case 3: 
1202   2                      for(i=0;i<999;i++)
1203   2                      Write_A_B(ECG1[i]/new,ECG1[i]/new,Channal_AB,1);
1204   2                      break;
1205   2              default:
1206   2                      for(i=0;i<999;i++)
1207   2                      Write_A_B(ECG1[i]/5,ECG1[i]/5,Channal_AB,1);
1208   2                      break; 
1209   2          }   */
1210   2                      for(i=0;i<999;i++)
1211   2                      Write_A_B(ECG1[i]/new,ECG1[i]/new,Channal_AB,1);
1212   2                      //i=0;
1213   2                      //for(i=0;i<999;i++)    
1214   2                              //Write_A_B(ECG3[i],ECG3[i],Channal_AB,1);   //测量通道
1215   2         }
1216   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    399    ----
   CONSTANT SIZE    =   2000    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
